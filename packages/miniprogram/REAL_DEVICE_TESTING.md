# 真机测试快速开始指南

## 🎯 目标
在真实的 iOS 和 Android 设备上测试轻图小程序，确保所有功能正常运行。

---

## 📱 方法 1: 微信开发者工具预览（推荐）

### 步骤 1: 构建小程序
```bash
cd packages/miniprogram
npm run build:weapp
```

### 步骤 2: 打开微信开发者工具
1. 启动微信开发者工具
2. 选择"小程序"项目类型
3. 项目目录选择: `packages/miniprogram`
4. AppID: 使用测试号或填写 `touristappid`（游客模式）

### 步骤 3: 生成预览二维码
1. 点击工具栏的"预览"按钮
2. 选择"自动预览"
3. 等待编译完成，生成二维码

### 步骤 4: 手机扫码测试
1. 打开微信扫一扫
2. 扫描开发者工具显示的二维码
3. 进入小程序开始测试

**优点**:
- ✅ 快速便捷，无需上传
- ✅ 支持热更新（修改后重新预览）
- ✅ 可查看 vConsole 调试信息

**限制**:
- ⚠️ 仅开发者微信账号可扫码（需在小程序管理后台添加开发者）
- ⚠️ 二维码有效期 30 分钟

---

## 📱 方法 2: 体验版发布（团队测试）

### 步骤 1: 上传代码
```bash
# 构建生产版本
npm run build:weapp

# 在微信开发者工具中
1. 点击"上传"按钮
2. 填写版本号: 1.2.0
3. 填写项目备注: 功能测试版本
4. 点击"上传"
```

### 步骤 2: 设为体验版
1. 登录 [微信公众平台](https://mp.weixin.qq.com)
2. 进入"开发管理" → "开发版本"
3. 找到刚上传的版本 (1.2.0)
4. 点击"选为体验版"

### 步骤 3: 添加体验成员
1. 在"成员管理" → "体验成员"中添加测试人员微信号
2. 测试人员可通过以下方式访问：
   - 扫描体验版二维码
   - 微信搜索小程序名称（显示"体验版"标签）

**优点**:
- ✅ 多人协同测试
- ✅ 无二维码过期限制
- ✅ 接近真实用户环境

**限制**:
- ⚠️ 需要已认证的小程序账号
- ⚠️ 体验成员上限 100 人

---

## 📱 方法 3: 真机调试（深度调试）

### 适用场景
- 需要查看详细的 console 日志
- 需要调试网络请求
- 需要检查性能指标

### 步骤
1. 微信开发者工具点击"真机调试"
2. 选择设备（通过 USB 连接或同一 Wi-Fi）
3. 扫描二维码启动调试
4. 开发者工具显示真机 console 日志和网络面板

**优点**:
- ✅ 完整的调试能力
- ✅ 实时查看日志和网络请求
- ✅ 性能分析工具

**限制**:
- ⚠️ 需要 USB 连接（iOS）或同一 Wi-Fi（Android）
- ⚠️ 仅支持开发者账号

---

## 🧪 推荐测试流程

### 第一轮: 开发者快速验证（1小时）
**使用方法 1 (预览二维码)**
1. 开发者使用自己的 iOS/Android 设备扫码
2. 快速执行 TESTING.md 中的核心功能测试
3. 发现明显问题立即修复

### 第二轮: 团队全面测试（1-2天）
**使用方法 2 (体验版)**
1. 发布体验版，添加 5-10 名测试成员
2. 分配测试任务（按设备型号和系统版本）
3. 执行完整测试矩阵（TESTING.md）
4. 收集反馈，修复问题

### 第三轮: 真机深度调试（半天）
**使用方法 3 (真机调试)**
1. 针对第二轮发现的复杂问题
2. 使用真机调试工具定位根因
3. 性能优化和兼容性调整

---

## 📋 测试前准备清单

### 开发环境
- [ ] 微信开发者工具已安装（最新稳定版）
- [ ] 项目已成功编译（`npm run build:weapp`）
- [ ] 小程序 AppID 已配置（project.config.json）

### 测试账号
- [ ] 微信开发者账号已注册
- [ ] 小程序已创建（或使用测试号）
- [ ] 开发者已添加到项目成员

### 测试设备
- [ ] 至少 1 台 iOS 设备（iPhone）
- [ ] 至少 1 台 Android 设备
- [ ] 设备微信版本 ≥ 8.0.0
- [ ] 设备已联网

### 测试素材
- [ ] 准备 9 张测试图片（不同格式、不同大小）
- [ ] 准备 HEIC 格式图片（iOS 测试）
- [ ] 准备超大图片（>10MB）测试边界情况

---

## 🐛 常见问题

### Q1: 扫码后提示"小程序未发布"
**解决方案**:
- 确认使用的是"预览"二维码，不是"体验版"二维码
- 或确认体验版已正确设置

### Q2: 扫码后提示"开发者工具未登录"
**解决方案**:
- 在微信开发者工具中登录微信账号
- 确保登录的账号已添加为开发者

### Q3: 真机调试连接失败
**解决方案**:
- **iOS**: 检查 USB 连接，信任电脑，开启"开发者模式"
- **Android**: 开启 USB 调试，同一 Wi-Fi 下测试

### Q4: 图片处理失败或闪退
**排查步骤**:
1. 打开 vConsole（体验版小程序右上角 → 打开调试）
2. 查看 Console 和 Network 面板
3. 检查是否有权限问题（相册授权）
4. 检查是否是内存不足（大文件处理）

### Q5: 不同设备表现不一致
**排查步骤**:
1. 记录设备型号、系统版本、微信版本
2. 使用真机调试对比日志
3. 检查是否是系统 API 兼容性问题

---

## 📊 测试数据收集

### 每次测试记录以下信息
```markdown
**测试日期**: 2025-10-08
**测试人员**: [姓名]
**设备信息**:
- 型号: iPhone 13
- 系统: iOS 16.5
- 微信: 8.0.40

**测试结果**:
- ✅ 功能模块: 图片选择、格式转换、批量裁剪...
- ❌ 失败模块: [具体描述]
- 📝 备注: [其他发现]

**性能数据**:
- 9 张图片处理时间: 12秒
- 内存占用峰值: 135MB
- 是否卡顿: 否
```

---

## 🎯 测试成功标准

### 功能完整性
- [ ] 所有核心功能正常（选择、转换、裁剪、重命名、压缩、保存）
- [ ] 所有边界情况处理正确（大文件、权限拒绝等）

### 性能指标
- [ ] 9 张标准图片处理时间 ≤ 15 秒
- [ ] 内存占用 ≤ 200MB
- [ ] 无卡顿、无闪退

### 兼容性
- [ ] 至少 3 款 iOS 设备测试通过
- [ ] 至少 4 款 Android 设备测试通过
- [ ] 深色模式正常显示

### 用户体验
- [ ] 操作流畅，响应及时
- [ ] 错误提示清晰友好
- [ ] UI 显示正常，无错位

---

## 📞 技术支持

### 微信官方文档
- 小程序开发文档: https://developers.weixin.qq.com/miniprogram/dev/framework/
- 真机调试指南: https://developers.weixin.qq.com/miniprogram/dev/devtools/remote-debug.html
- 体验版发布: https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/release.html

### Taro 文档
- Taro 官方文档: https://taro-docs.jd.com/docs/
- 小程序适配: https://taro-docs.jd.com/docs/miniprogram

### 问题反馈
- 项目 Issues: [GitHub Issues](https://github.com/your-repo/issues)
- 团队群组: [内部沟通群]

---

**开始测试吧！** 🚀
